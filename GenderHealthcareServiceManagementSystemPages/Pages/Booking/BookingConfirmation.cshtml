@page
@model GenderHealthcareServiceManagementSystemPages.Pages.Booking.BookingConfirmationModel
@{
    ViewData["Title"] = "Xác nhận đặt lịch - Gender Healthcare";
    Layout = null;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="/css/BookingConfirmation.css" />
</head>
<body>
    <div class="container">
        <div class="confirmation-card">
            <div class="success-icon">✓</div>

            <h1 class="confirmation-title">Đặt lịch thành công!</h1>
            <p class="confirmation-subtitle">
                Cảm ơn bạn đã tin tưởng Gender Healthcare. Chúng tôi đã nhận được yêu cầu đặt lịch của bạn và sẽ liên hệ xác nhận trong thời gian sớm nhất.
            </p>

            <div class="booking-id">
                <div class="booking-id-label">Mã đặt lịch của bạn</div>
                <div class="booking-id-value" onclick="copyBookingId('@Model.BookingId')">#@Model.BookingId</div>
            </div>

            <div class="booking-details">
                <h3>📋 Chi tiết cuộc hẹn</h3>

                <div class="detail-row">
                    <span class="detail-label">Chuyên gia tư vấn:</span>
                    <div class="consultant-info">
                        <div class="consultant-avatar">@(Model.ConsultantInfo.Consultant.Gender == "Female" ? "👩‍⚕️" : "👨‍⚕️")</div>
                        <div class="consultant-details">
                            <div class="consultant-name">@Model.ConsultantInfo.Consultant.FullName</div>
                            <div class="consultant-specialty">@Model.ConsultantInfo.Specialization</div>
                        </div>
                    </div>
                </div>

                <div class="detail-row">
                    <span class="detail-label">Ngày hẹn:</span>
                    <span class="detail-value">@Model.AppointmentDate</span>
                </div>

                <div class="detail-row">
                    <span class="detail-label">Giờ hẹn:</span>
                    <span class="detail-value">@Model.AppointmentTime</span>
                </div>

                @* <div class="detail-row">
                    <span class="detail-label">Họ tên:</span>
                    <span class="detail-value">@Model.PatientName</span>
                </div>

                <div class="detail-row">
                    <span class="detail-label">Số điện thoại:</span>
                    <span class="detail-value">@Model.PhoneNumber</span>
                </div> *@

                <div class="detail-row">
                    <span class="detail-label">Trạng thái:</span>
                    <span class="detail-value">@Model.ConsultationStatus</span>
                </div>
            </div>

            <div class="action-buttons">
                <a href="/my-appointments" class="btn btn-primary">📅 Xem lịch hẹn của tôi</a>
                <a href="/" class="btn btn-secondary">🏠 Về trang chủ</a>
            </div>

            <div class="contact-info">
                <h3>📞 Cần hỗ trợ?</h3>

                <div class="contact-item">
                    <div class="contact-icon">📞</div>
                    <span>Hotline: 1900 1234 (24/7)</span>
                </div>

                <div class="contact-item">
                    <div class="contact-icon">✉️</div>
                    <span>Email: support@genderhealthcare.vn</span>
                </div>

                <div class="contact-item">
                    <div class="contact-icon">📍</div>
                    <span>Nhà văn hóa sinh viên, TP.HCM</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Booking Confirmation Page JavaScript
        document.addEventListener("DOMContentLoaded", () => {
            // Animate success icon on page load
            animateSuccessIcon()

            // Add ripple effect to buttons
            initializeButtonRippleEffect()

            // Add smooth scroll for any anchor links
            initializeSmoothScroll()
        })

        function animateSuccessIcon() {
            const successIcon = document.querySelector(".success-icon")
            if (successIcon) {
                setTimeout(() => {
                    successIcon.style.transform = "scale(1.1)"
                    setTimeout(() => {
                        successIcon.style.transform = "scale(1)"
                    }, 200)
                }, 500)
            }
        }

        function initializeButtonRippleEffect() {
            document.querySelectorAll(".btn").forEach((btn) => {
                btn.addEventListener("click", function (e) {
                    createRippleEffect(e, this)
                })
            })
        }

        function createRippleEffect(e, button) {
            // Remove any existing ripples
            const existingRipple = button.querySelector(".ripple-effect")
            if (existingRipple) {
                existingRipple.remove()
            }

            // Create new ripple element
            const ripple = document.createElement("span")
            ripple.classList.add("ripple-effect")

            // Calculate position and size
            const rect = button.getBoundingClientRect()
            const size = Math.max(rect.width, rect.height)
            const x = e.clientX - rect.left - size / 2
            const y = e.clientY - rect.top - size / 2

            // Set ripple properties
            ripple.style.width = ripple.style.height = size + "px"
            ripple.style.left = x + "px"
            ripple.style.top = y + "px"

            // Add ripple to button
            button.appendChild(ripple)

            // Remove ripple after animation
            setTimeout(() => {
                if (ripple.parentNode) {
                    ripple.remove()
                }
            }, 600)
        }

        function initializeSmoothScroll() {
            document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
                anchor.addEventListener("click", function (e) {
                    e.preventDefault()
                    const target = document.querySelector(this.getAttribute("href"))
                    if (target) {
                        target.scrollIntoView({
                            behavior: "smooth",
                            block: "start",
                        })
                    }
                })
            })
        }

        function copyBookingId(bookingId) {
            if (navigator.clipboard) {
                navigator.clipboard
                    .writeText(bookingId)
                    .then(() => {
                        showNotification("Đã sao chép mã đặt lịch!", "success")
                    })
                    .catch(() => {
                        fallbackCopyToClipboard(bookingId)
                    })
            } else {
                fallbackCopyToClipboard(bookingId)
            }
        }

        function fallbackCopyToClipboard(text) {
            const textArea = document.createElement("textarea")
            textArea.value = text
            textArea.style.position = "fixed"
            textArea.style.left = "-999999px"
            textArea.style.top = "-999999px"
            document.body.appendChild(textArea)
            textArea.focus()
            textArea.select()

            try {
                document.execCommand("copy")
                showNotification("Đã sao chép mã đặt lịch!", "success")
            } catch (err) {
                showNotification("Không thể sao chép. Vui lòng copy thủ công.", "error")
            }

            document.body.removeChild(textArea)
        }

        function showNotification(message, type = "info") {
            // Remove existing notifications
            const existingNotification = document.querySelector(".notification")
            if (existingNotification) {
                existingNotification.remove()
            }

            // Create notification element
            const notification = document.createElement("div")
            notification.className = `notification notification-${type}`
            notification.textContent = message

            // Add notification styles
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === "success" ? "#48BB78" : type === "error" ? "#F56565" : "#4299E1"};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 500;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `

            // Add to page
            document.body.appendChild(notification)

            // Animate in
            setTimeout(() => {
                notification.style.transform = "translateX(0)"
            }, 100)

            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = "translateX(100%)"
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove()
                    }
                }, 300)
            }, 3000)
        }

        function printConfirmation() {
            window.print()
        }

        function shareBookingDetails(bookingData) {
            if (navigator.share) {
                navigator
                    .share({
                        title: "Xác nhận đặt lịch - Gender Healthcare",
                        text: `Đã đặt lịch thành công với ${bookingData.consultant} vào ${bookingData.date} lúc ${bookingData.time}`,
                        url: window.location.href,
                    })
                    .catch((err) => {
                        console.log("Error sharing:", err)
                    })
            } else {
                // Fallback: copy URL to clipboard
                copyBookingId(window.location.href)
            }
        }

    </script>
</body>
</html>

