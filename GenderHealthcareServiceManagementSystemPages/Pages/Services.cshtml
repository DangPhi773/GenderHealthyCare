@page
@model GenderHealthcareServiceManagementSystemPages.Pages.ServicesModel
@{
    ViewData["Title"] = "Dịch vụ";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />

<div class="container py-5">
    <div class="text-center mb-5">
        <span class="badge bg-light text-purple border border-purple mb-3 px-3 py-2 fs-6">
            <i class="bi bi-heart-fill text-danger me-2"></i>Gender Healthcare System
        </span>
        <h1 class="display-5 fw-bold text-dark">Các gói dịch vụ</h1>
        <p class="lead text-muted">Khám phá các dịch vụ chăm sóc sức khỏe chất lượng cao được thiết kế phù hợp với nhu cầu của bạn</p>
    </div>
    <form method="get" class="text-center mb-5">
        <div class="btn-group filter-group" role="group">
            @foreach (var option in new[] { "Tất cả", "Tiết kiệm", "Phổ thông", "Cao cấp" })
            {
                var inputId = $"filter-{option.Replace(" ", "")}";
                <input type="radio" class="btn-check" name="FilterCategory" value="@option" id="@inputId" autocomplete="off"
                @(Model.FilterCategory == option ? "checked" : "") />
                <label class="btn btn-outline-purple custom-filter-label" for="@inputId">@option</label>
            }
        </div>
        <button type="submit" class="btn btn-gradient ms-3">
            <i class="bi bi-funnel me-1"></i> Lọc
        </button>
    </form>

    <div class="row g-4">
        @if (Model.Services != null && Model.Services.Count > 0)
        {
            @foreach (var service in Model.Services)
            {
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 shadow-sm border-0">
                        <div class="card-header bg-white border-bottom-0 py-3">
                            <h5 class="card-title fw-bold text-purple m-0 d-flex align-items-center">
                                <i class="bi bi-shield-check me-2 text-gradient"></i> @service.Name
                            </h5>
                        </div>

                        <div class="card-body">
                            <p class="card-text text-muted">@service.Description</p>

                            <ul class="list-unstyled small">
                                <li class="mb-1">
                                    <i class="bi bi-clock me-2 text-primary"></i>Thời gian: <span class="text-dark">(Cập nhật thủ công)</span>
                                </li>
                                <li class="mb-1">
                                    <i class="bi bi-check-circle me-2 text-success"></i>Chất lượng được đảm bảo
                                </li>
                                <li class="mb-1">
                                    <i class="bi bi-person-check me-2 text-info"></i>Phù hợp với từng đối tượng
                                </li>
                            </ul>

                            <div class="bg-light rounded p-3 text-center mt-3">
                                <div class="fw-bold fs-5 text-purple">@service.Price.ToString("N0") VND</div>
                                <small class="text-muted">Giá gói dịch vụ</small>
                            </div>
                        </div>
                        <div class="card-footer bg-transparent border-0 d-grid gap-2">
                            <a asp-page="/CustomerTesting/SelectService" class="btn btn-gradient text-white" style="background: linear-gradient(to right, #8b5cf6, #ec4899);">
                                <i class="bi bi-calendar-check me-2"></i>Đăng ký dịch vụ
                            </a>
                            <a href="#" class="btn btn-outline-purple">
                                <i class="bi bi-telephone me-2"></i>Tư vấn miễn phí
                            </a>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="col-12">
                <div class="text-center py-5 bg-white shadow rounded">
                    <i class="bi bi-shield-slash display-4 text-muted"></i>
                    <h3 class="mt-3">Không có dịch vụ nào</h3>
                    <p class="text-muted">Hiện tại chưa có dịch vụ nào được hiển thị trong hệ thống.</p>

                </div>
            </div>
        }
    </div>
</div>

<style>
    .btn-gradient {
        background: linear-gradient(to right, #a855f7, #ec4899);
        color: white;
        border: none;
    }

    .btn-outline-purple {
        border: 1px solid #c084fc;
        color: #9333ea;
    }

    .text-purple {
        color: #9333ea;
    }

    .border-purple {
        border-color: #c084fc !important;
    }

    .filter-group .btn-check:checked + .custom-filter-label {
        background: linear-gradient(to right, #a855f7, #ec4899);
        color: white;
        border-color: transparent;
    }

    .text-gradient {
        background: linear-gradient(to right, #a855f7, #ec4899);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .card-title {
        font-size: 1.1rem;
    }

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>
<script>
    const connection = new signalR.HubConnectionBuilder()
        .withUrl("/signalrserver") 
        .build();

    connection.start()
        .then(() => console.log("SignalR connected"))
        .catch(err => console.error("SignalR connection error: ", err));

    connection.on("ServiceUpdated", function (updatedService) {
        alert("Dịch vụ đã được cập nhật: " + updatedService.name);
        location.reload();
    });
</script>
